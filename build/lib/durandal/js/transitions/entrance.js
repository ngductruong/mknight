define(["durandal/system","durandal/composition","jquery"],function(e,t,n){var r=200,i={marginRight:0,marginLeft:0,opacity:1},o={marginLeft:"",marginRight:"",opacity:"",display:""},a=function(t){return e.defer(function(e){function a(){e.resolve()}function s(){t.keepScrollPosition||n(document).scrollTop(0)}function u(){s(),t.triggerAttach();var e={marginLeft:c?"0":"0px",marginRight:c?"0":"0px",opacity:0,display:"block"},r=n(t.child);r.css(e),r.animate(i,{duration:l,easing:"swing",always:function(){r.css(o),a()}})}if(t.child){var l=t.duration||200,c=!!t.fadeOnly;t.activeView?n(t.activeView).fadeOut({duration:r,always:u}):u()}else n(t.activeView).fadeOut(r,a)}).promise()};return a});